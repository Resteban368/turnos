<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>M√≥dulo ‚Äî Sistema de Turnos</title>
    <meta name="description" content="Vista del operador de m√≥dulo: turno actual, llamar, siguiente y pausar." />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/modulo.css" />
</head>

<body class="modulo-page">

    <!-- ========================================================
     VISTA DEL OPERADOR DE M√ìDULO (1‚Äì4)
     El m√≥dulo se determina por el par√°metro ?mod=N en la URL.
     Muestra el turno actual, permite llamar, avanzar y pausar.
     ======================================================== -->

    <!-- Barra de navegaci√≥n -->
    <nav class="navbar">
        <div class="navbar-brand">
            <div class="navbar-brand-logo">üè•</div>
            <span class="navbar-brand-text">Sistema de Turnos</span>
        </div>
        <div class="navbar-right">
            <!-- Estado del m√≥dulo (badge din√°mico) -->
            <span class="badge" id="nav-status-badge">Activo</span>
            <button class="btn btn-secondary btn-sm" onclick="logout()">üö™ Salir</button>
        </div>
    </nav>

    <!-- Contenido principal centrado -->
    <main>
        <div class="modulo-layout">

            <!-- === Tarjeta principal del turno === -->
            <div class="turno-card animate-in" id="turno-card">

                <!-- Cabecera: n√∫mero de m√≥dulo + estado -->
                <div class="turno-card-header">
                    <div class="modulo-title">
                        <div class="modulo-num" id="modulo-num-icon">1</div>
                        <span>M√≥dulo <span id="modulo-num-text">1</span></span>
                    </div>
                    <span class="badge badge-active" id="module-status-badge">
                        <span class="dot dot-active"></span> Activo
                    </span>
                </div>

                <!-- Banner de estado (visible solo cuando pausado o inactivo) -->
                <div class="state-banner" id="state-banner"></div>

                <!-- Cuerpo: turno actual -->
                <div class="turno-card-body" id="turno-card-body">

                    <!-- Vista cuando hay turno activo -->
                    <div id="turno-content" style="display:none;">
                        <div class="turno-doc-label">Documento de Identidad</div>
                        <div class="turno-doc-value" id="turno-doc">‚Äî</div>

                        <div class="turno-numero" id="turno-numero">A01</div>

                        <!-- Badge de prioridad (visible si es alta prioridad) -->
                        <div id="priority-badge" style="display:none; justify-content:center; margin-bottom:1rem;">
                            <span class="badge badge-high">üî¥ Alta Prioridad</span>
                        </div>
                    </div>

                    <!-- Vista cuando no hay turno activo -->
                    <div class="turno-empty" id="turno-empty">
                        <div class="turno-empty-icon">üéüÔ∏è</div>
                        <div class="turno-empty-text">Sin turno asignado</div>
                        <div class="turno-empty-sub" id="empty-sub-text">Esperando pr√≥ximo en cola...</div>
                    </div>

                </div><!-- /turno-card-body -->
            </div><!-- /turno-card -->

            <!-- === Botones de acci√≥n === -->
            <div class="turno-actions" id="turno-actions">

                <!-- Bot√≥n Llamar -->
                <button class="btn-llamar" id="btn-llamar" disabled>
                    <span class="btn-icon">üîî</span>
                    <span>Llamar</span>
                </button>

                <!-- Bot√≥n Atendiendo -->
                <button class="btn-atendiendo" id="btn-atendiendo" disabled>
                    <span class="btn-icon">üë®‚Äç‚öïÔ∏è</span>
                    <span>Atendiendo</span>
                </button>

                <!-- Bot√≥n Siguiente -->
                <button class="btn-siguiente" id="btn-siguiente" disabled>
                    <span class="btn-icon">‚è≠Ô∏è</span>
                    <span>Siguiente</span>
                </button>

            </div>

            <!-- Bot√≥n de Pausar / Reanudar -->
            <button class="btn-pausa pausar" id="btn-pausa" disabled>
                <span id="pausa-icon">‚è∏Ô∏è</span>
                <span id="pausa-text">Pausar servicio</span>
            </button>

            <!-- Panel de informaci√≥n de la cola -->
            <div class="queue-info" id="queue-info" style="margin-top: 1rem;">
                <div class="queue-info-item">
                    <div class="queue-info-value" id="qi-high">0</div>
                    <div class="queue-info-label">üî¥ Alta Prioridad</div>
                </div>
                <div class="queue-info-item">
                    <div class="queue-info-value" id="qi-normal">0</div>
                    <div class="queue-info-label">üîµ Normal</div>
                </div>
                <div class="queue-info-item">
                    <div class="queue-info-value" id="qi-total">0</div>
                    <div class="queue-info-label">üìã Total en espera</div>
                </div>
            </div>

            <!-- Timer de servicio y log de llamados -->
            <div class="service-details animate-in" id="service-details" style="display:none; margin-top: 1.5rem;">
                <div class="detail-card">
                    <div class="detail-header">
                        <span class="detail-title">‚è±Ô∏è Tiempo de Atenci√≥n</span>
                        <div class="timer-badge" id="service-timer">00:00</div>
                    </div>
                </div>

                <div class="detail-card" style="margin-top: 1rem;">
                    <div class="detail-header" style="flex-direction: column; align-items: flex-start; gap: 0.75rem;">
                        <span class="detail-title">üìû Historial de Llamados</span>
                        <div class="search-box" style="width: 100%;">
                            <input type="text" id="search-calls" class="input-field" placeholder="Buscar turno (ej: A01)..." style="font-size: 0.8rem; padding: 0.5rem; width: 100%;">
                        </div>
                    </div>
                    <div class="calls-log" id="calls-log">
                        <div class="log-empty">No se han realizado llamados a√∫n</div>
                    </div>
                </div>

                <!-- Turnos Atendidos (Acorde√≥n) -->
                <div class="detail-card" style="margin-top: 1rem;">
                    <button class="accordion-header" id="btn-toggle-attended" style="width: 100%; border: none; background: none; padding: 0; outline: none; cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                        <span class="detail-title" style="margin: 0;">‚úÖ Turnos Atendidos</span>
                        <span class="accordion-icon" id="accordion-icon">‚ñº</span>
                    </button>
                    <div class="accordion-content" id="attended-content" style="display: none; margin-top: 1rem;">
                        <div class="finished-tickets-log" id="finished-tickets-log">
                            <div class="log-empty">No hay turnos finalizados a√∫n</div>
                        </div>
                    </div>
                </div>
            </div>

        </div><!-- /modulo-layout -->
    </main>

    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/tickets.js"></script>
    <script src="js/sound.js"></script>
    <script src="js/modulo.js"></script>

</body>

</html>